
<table id="transaction-history-table-detailed" class="table table-striped table-responsive table-hover table-condensed">
  <tbody>
    <tr>
      <td><input class="form-control" id="filter-date" placeholder="Date" type="text"></td>
      <td><input class="form-control" id="filter-amount" placeholder="Amount" type="text"></td>
      <td></td>
      <td><input class="form-control" id="filter-name" placeholder="Filter by Contact Name" type="text"></td>
      <td></td>
    </tr>
    <% @display.each_with_index do |e, i| %>
      <tr class="popuppable" data-load="<%= e[:load] %>" >
        <td class="fit-to-contents first-column"><div>
            <%= e[:display_time] %>
        </div></td>

        <td class="fit-to-contents"><div>
          <span class="label label-<%= (e[:money_direction] || e[:direction]) == :to ? 'danger' : 'success' %> amount"><%= e[:amount] %></span>
        </div></td>

        <td class="fit-to-contents"><div>
          <% if e[:transfer_type] %>
            <%= e[:transfer_type] %>
          <% else %>
            <%= e[:direction] == :to ? '<i class="fa fa-long-arrow-right"></i>'.html_safe : '<i class="fa fa-long-arrow-left"></i>'.html_safe%>
          <% end %>
        </div></td>

        <td class="ellipsis"><div>
          <div class="td-truncate">
          <%= e[:target] %>
          </div>
        </div></td>

        <td class="fit-to-contents last-column"><div>
          <%=
            case e[:target_type]
            when :bitstation
              '<span title="This person is a MIT user" class="label label-danger">M</span>'
            when :coinbase
              '<span title="This person is a Coinbase user" class="label label-info">C</span>'
            when :external
              '<span title="This person is an external user" class="label label-success">E</span>'
            end.html_safe
          %>

          <% if e[:pending] %>
            <span title="This <%= activity %> is pending" class="label label-warning">P</span>
          <% end %>

          <% if e[:success] %>
            <span title="This <%= activity %> is <%= e[:success] %>" class="label label-success"><%= e[:success][0].upcase %></span>
          <% end %>

          <% if e[:failure] %>
            <span title="This <%= activity %> is <%= e[:failure] %>" class="label label-danger"><%= e[:failure][0].upcase %></span>
          <% end %>
        </div></td>
      </tr>
    <% end %>
  </tbody>
</table>

<script>
  window.recalculate_truncate_width("#transaction-history-table-detailed")
  $("#filter-name").change(function() {
    return $("#transaction-history-table-detailed").filterTable($("#filter-name").val());
  }).keyup(function() {
    return $(this).change();
  });
</script>